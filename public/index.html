<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Stripe Embedded Checkout Demo</title>
    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        padding: 40px;
        max-width: 600px;
        margin: 0 auto;
      }
      #checkout {
        margin-top: 24px;
      }
    </style>
    <script src="https://js.stripe.com/v3/"></script>
  </head>
  <body>
    <h1>Embedded Checkout – Multi‑method demo</h1>
    <p>
      This page shows Stripe’s prebuilt embedded Checkout form with multiple
      payment methods enabled in your Dashboard.
    </p>

    <div id="checkout"></div>

    <script type="module">
      const stripe = Stripe(
        "pk_test_xxx_replace_with_your_publishable_key"
      );

      async function fetchClientSecret() {
        const res = await fetch("/create-checkout-session", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
        });

        const data = await res.json();
        if (!data.clientSecret) {
          throw new Error("No clientSecret returned");
        }
        return data.clientSecret;
      }

      async function setupEmbeddedCheckout() {
        const clientSecret = await fetchClientSecret();

        const checkout = await stripe.initEmbeddedCheckout({
          clientSecret,
        });

        checkout.mount("#checkout");
      }

      setupEmbeddedCheckout().catch((err) => {
        console.error(err);
        document.getElementById("checkout").innerText =
          "Error loading Checkout: " + err.message;
      });
    </script>
  </body>
</html>
